---
apiVersion: v1
kind: ConfigMap
metadata:
  name: iceberg-optimization-config
  namespace: data-platform
data:
  iceberg.properties: |
    # Iceberg optimization properties
    # These properties will be used by Spark, Trino, and other engines

    # Table properties for optimization
    iceberg.table-defaults.write.metadata.delete-after-commit.enabled=true
    iceberg.table-defaults.write.metadata.previous-versions-max=5

    # Compaction settings
    iceberg.table-defaults.write.target-file-size-bytes=536870912
    iceberg.table-defaults.write.parquet.row-group-size-bytes=134217728

    # Metadata caching
    iceberg.table-defaults.metadata.cache.enabled=true
    iceberg.table-defaults.metadata.cache.max-entries=10000

    # Snapshot management
    iceberg.table-defaults.write.cleanup.enabled=true
    iceberg.table-defaults.write.cleanup.snapshot-keep-min=5

    # Performance optimizations
    iceberg.table-defaults.write.distribution-mode=hash
    iceberg.table-defaults.write.upsert.enabled=true
