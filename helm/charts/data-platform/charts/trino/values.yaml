# Trino values
replicaCount:
  coordinator: 1
  worker: 1

image:
  repository: trinodb/trino
  tag: "436"
  pullPolicy: IfNotPresent

service:
  coordinator:
    type: ClusterIP
    port: 8080
  worker:
    type: ClusterIP
    port: 8080

# Ingress configuration
ingress:
  enabled: false
  className: "nginx"
  hostname: trino.254carbon.com
  tls: true
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod

catalogs:
  - name: iceberg_catalog
    type: iceberg
    properties:
      iceberg.catalog.type: rest
      iceberg.rest-catalog.uri: http://iceberg-rest-catalog:8181
  - name: postgresql
    type: postgresql
    properties:
      connection-url: jdbc:postgresql://postgres-shared-service:5432/datahub
      connection-user: postgres

resources:
  coordinator:
    requests:
      cpu: 2000m
      memory: 6Gi
    limits:
      cpu: 4000m
      memory: 8Gi
  worker:
    requests:
      cpu: 3000m
      memory: 6Gi
    limits:
      cpu: 4000m
      memory: 8Gi

autoscaling:
  enabled: true
  worker:
    minReplicas: 1
    maxReplicas: 5
    targetCPUUtilizationPercentage: 75
    targetMemoryUtilizationPercentage: 85

# Query performance settings
config:
  query:
    max-memory: 50GB
    max-memory-per-node: 8GB
  task:
    max-worker-threads: 32
    min-drivers: 2

# Resource groups configuration for query management
resourceGroups:
  enabled: false

# KEDA-based autoscaling configuration
keda:
  enabled: false
  minReplicas: 1
  maxReplicas: 10
  cooldownPeriod: 300
  pollingInterval: 30

serviceAccount:
  create: true
  annotations: {}
  name: ""

httpRoute:
  enabled: false

# S3 / MinIO defaults for Iceberg file system access
s3:
  endpoint: http://minio-service:9000
  region: us-east-1
  # Keep as string to avoid YAML bool coercion in Helm templating
  pathStyle: true

# Disable simple scaffolded templates in favor of explicit coordinator/worker manifests
simple:
  enabled: false
