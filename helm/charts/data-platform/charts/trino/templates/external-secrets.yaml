---
# ExternalSecret for MinIO credentials
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: minio-credentials
  namespace: data-platform
  labels:
    app: trino
    component: secrets
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: vault-backend
    kind: SecretStore
  target:
    name: minio-credentials
    creationPolicy: Owner
  data:
  - secretKey: accesskey
    remoteRef:
      key: minio/credentials
      property: accesskey
  - secretKey: secretkey
    remoteRef:
      key: minio/credentials
      property: secretkey

---
# ExternalSecret for ClickHouse Trino user password
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: clickhouse-trino-password
  namespace: data-platform
  labels:
    app: trino
    component: secrets
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: vault-backend
    kind: SecretStore
  target:
    name: clickhouse-trino-password
    creationPolicy: Owner
  data:
  - secretKey: password
    remoteRef:
      key: clickhouse/users/trino
      property: password
